(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function fe(r,e,t){let n=r[e];return n||(n=t(),r[e]=n),n}const c={none:0,left:1,up:2,right:4,down:8},_={0:c.right|c.down,1:c.left|c.down|c.right,2:c.left|c.down,3:c.up,4:c.up|c.right|c.down,5:c.left|c.up|c.right|c.down,6:c.up|c.left|c.down,7:c.right,8:c.up|c.right,9:c.left|c.up|c.right,10:c.up|c.left,11:c.left,12:c.left|c.right,13:c.none,14:c.up|c.down,15:c.down},ge=Object.entries(_).reduce((r,[e,t])=>{if(fe(r,t,()=>parseInt(e))!=parseInt(e))throw new Error("failed to create tiling mapping: found a duplicate tiling rule: "+t.toString(2));return r},{}),he={left:{x:-1,y:0},up:{x:0,y:-1},right:{x:1,y:0},down:{x:0,y:1}};function me(r,e){if(r==null)throw new Error(e);return r}const C=16,be=3,R=Object.freeze({w:4,h:4}),I=0,pe="spritesheets",F=R.w*R.h,m=C*be;function ve(r,e){return e*r.y+r.x}function N(r,e){const t=Math.floor(r/e);return{x:r-e*t,y:t}}function K(r,e,t){return Math.max(Math.min(r,t),e)}function k(r,e,t){return r>=e&&r<=t}class Te{constructor(e,t){this._canvas=e,this._ctx=t,this._sizeTiles=Object.freeze({w:Math.floor(e.clientWidth/m),h:Math.floor(e.clientHeight/m)}),this._sizePixelsPadded=Object.freeze({w:this.sizeTiles.w*m,h:this.sizeTiles.h*m}),this._sizePixelsUnpadded=Object.freeze({w:this.sizePixelsPadded.w+I*2,h:this.sizePixelsPadded.h+I*2}),e.width=this.sizePixelsUnpadded.w,e.height=this.sizePixelsUnpadded.h}get sizeTiles(){return this._sizeTiles}_sizeTiles;get sizePixelsPadded(){return this._sizePixelsPadded}_sizePixelsPadded;get sizePixelsUnpadded(){return this._sizePixelsUnpadded}_sizePixelsUnpadded;_grid={};convertPxPositionToTilePos(e){return{x:K(Math.floor(e.x/m),0,this.sizeTiles.w),y:K(Math.floor(e.y/m),0,this.sizeTiles.h)}}convertTilePositionToTileGridIndex(e){return ve(e,this.sizeTiles.w)}convertTileGridIndexToTilePosition(e){return N(e,this.sizeTiles.w)}get(e){const t=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e);return this._grid[t]}getCardinalNeighbors(e){const t={left:void 0,up:void 0,right:void 0,down:void 0};for(const[n,i]of Object.entries(he)){const s=n,o={x:e.x+i.x,y:e.y+i.y};this.isTilePositionWithinGrid(o)&&(t[s]=this.get(o))}return t}set(e,t){const n=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e),i=t;this.assertGridIndexWithinGrid(n),i===void 0?delete this._grid[n]:this._grid[n]=i}hasAt(e){const t=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e);return this.assertGridIndexWithinGrid(t),this._grid[t]!==void 0}draw(e){const t=this._ctx;t.strokeStyle="hsl(0, 0%, 20%)";for(let n=0;n<=this.sizeTiles.w;n++){const i={x:m*n,y:0},s={x:m*n,y:this.sizePixelsPadded.h};t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(s.x,s.y),t.stroke()}for(let n=0;n<=this.sizeTiles.h;n++){const i={x:0,y:m*n},s={x:this.sizePixelsPadded.w,y:m*n};t.beginPath(),t.moveTo(i.x,i.y),t.lineTo(s.x,s.y),t.stroke()}for(let[n,i]of Object.entries(this._grid)){if(i===void 0)continue;const s=parseInt(n),o=this.convertTileGridIndexToTilePosition(s),l={x:o.x*m,y:o.y*m},a=e.tileset.calculateSpritesheetTileRegion(i);t.drawImage(e.tileset.image,a.x,a.y,a.w,a.h,l.x,l.y,m,m)}}clear(){this._grid={}}isTilePositionWithinGrid(e){return k(e.x,0,this.sizeTiles.w-1)&&k(e.y,0,this.sizeTiles.h-1)}isGridIndexWithinGrid(e){return k(e,0,this.sizeTiles.w*this.sizeTiles.h)}assertTilePositionWithinGrid(e){if(!this.isTilePositionWithinGrid(e))throw new Error("failed assert assertIsTilePositionWithinGrid: "+e)}assertGridIndexWithinGrid(e){if(!this.isGridIndexWithinGrid(e))throw new Error("failed assert assertGridIndexWithinGrid: "+e)}}class Pe{constructor(e,t){this._grid=e,this._tileset=t}get tileset(){return this._tileset}mode="brush";setTileset(e){this._tileset=e}setMode(e){this.mode=e}applyAt(e){if(!this._grid.isTilePositionWithinGrid(e))return;const t=this._grid.getCardinalNeighbors(e);switch(this.mode){case"brush":this.applyBrushMode(e,t);break;case"eraser":this.applyEraserMode(e);break;default:throw new Error("not impl brush mode: "+this.mode)}for(const[n,i]of Object.entries(t)){const s=n;if(i===void 0)continue;const o=he[s],l={x:e.x+o.x,y:e.y+o.y},a=this._grid.getCardinalNeighbors(l),g=this._tileset.convertCardinalNeighborsToTiling(a);this._grid.set(l,g)}}applyBrushMode(e,t){if(this._grid.hasAt(e))return;const n=this._tileset.convertCardinalNeighborsToTiling(t);this._grid.set(e,n)}applyEraserMode(e){this._grid.hasAt(e)&&this._grid.set(e,void 0)}}const ye=[{relPath:"ItmSealTemp01Sheet.png"},{relPath:"ItmWallBlueCaution01Loose.png"},{relPath:"ItmWallBlueCaution01Sheet.png"},{relPath:"ItmWallGrayBevel01Sheet.png"},{relPath:"ItmWallGrayCaution01Sheet.png"},{relPath:"ItmWallGrayPanel01Sheet.png"},{relPath:"ItmWallGreenCross01Sheet.png"},{relPath:"ItmWallGreenRing01Sheet.png"},{relPath:"ItmWallMetalBSheet.png"},{relPath:"ItmWallPanelWSheet.png"},{relPath:"ItmWallPurpleCross01Sheet.png"},{relPath:"ItmWallRedBand01Sheet.png"},{relPath:"ItmWallRedCross01Sheet.png"},{relPath:"ItmWallSheet.png"},{relPath:"ItmWallTanOrange01Sheet.png"},{relPath:"ItmWallThin1x1BlueSheet.png"},{relPath:"ItmWallThin1x1GrayCautionSheet.png"},{relPath:"ItmWallThin1x1GrayCautionSheet02.png"},{relPath:"ItmWallThin1x1GraySheet.png"},{relPath:"ItmWallThin1x1GreenSheet.png"},{relPath:"ItmWallThin1x1OrangeSheet.png"},{relPath:"ItmWallThin1x1RedSheet.png"},{relPath:"ItmWallThin1x1YellowSheet.png"},{relPath:"ItmWallWhiteCross01Sheet.png"},{relPath:"ItmWallWindowSheet.png"},{relPath:"ItmWallWindowSheetSq.png"},{relPath:"ItmWallYellowCaution01Sheet.png"},{relPath:"AeroParts/ItmWallAeroSheet.png"},{relPath:"AeroParts/ItmWallAeroSheetSq.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroExtWhite01Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt01Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt02Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt03Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt04Sheet.png"},{relPath:"Meat01/ItmMeat01EyeSheet.png"},{relPath:"Meat01/ItmMeat01HoofSheet.png"},{relPath:"Meat01/ItmMeat01HornSheet.png"},{relPath:"Meat01/ItmMeat01Sheet.png"}];function p(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function Q(r,e){for(var t="",n=0,i=-1,s=0,o,l=0;l<=r.length;++l){if(l<r.length)o=r.charCodeAt(l);else{if(o===47)break;o=47}if(o===47){if(!(i===l-1||s===1))if(i!==l-1&&s===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var a=t.lastIndexOf("/");if(a!==t.length-1){a===-1?(t="",n=0):(t=t.slice(0,a),n=t.length-1-t.lastIndexOf("/")),i=l,s=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=l,s=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,l):t=r.slice(i+1,l),n=l-i-1;i=l,s=0}else o===46&&s!==-1?++s:s=-1}return t}function xe(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var b={process_cwd:"",setCWD:function(e){b.process_cwd=e},resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var s;i>=0?s=arguments[i]:(n===void 0&&(n=b.process_cwd),s=n),p(s),s.length!==0&&s+"/"!==e&&(e=s+"/"+e,t=s.charCodeAt(0)===47)}return e=Q(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(p(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=Q(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return p(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];p(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":b.normalize(e)},relative:function(e,t){if(p(e),p(t),e===t)return"";const n=e.replaceAll("\\","/"),i=t.replaceAll("\\","/");if(n!=e&&i!=t)return b.relative(n,i).replaceAll("/","\\");if(n!=e)return b.relative(n,t).replaceAll("/","\\");if(i!=t)return b.relative(e,i);if(e=b.resolve(e),t=b.resolve(t),e===t)return"";for(var s=1;s<e.length&&e.charCodeAt(s)===47;++s);for(var o=e.length,l=o-s,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var g=t.length,h=g-a,f=l<h?l:h,y=-1,u=0;u<=f;++u){if(u===f){if(h>f){if(t.charCodeAt(a+u)===47)return t.slice(a+u+1);if(u===0)return t.slice(a+u)}else l>f&&(e.charCodeAt(s+u)===47?y=u:u===0&&(y=0));break}var J=e.charCodeAt(s+u),ue=t.charCodeAt(a+u);if(J!==ue)break;J===47&&(y=u)}var A="";for(u=s+y+1;u<=o;++u)(u===o||e.charCodeAt(u)===47)&&(A.length===0?A+="..":A+="/..");return A.length>0?A+t.slice(a+y):(a+=y,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(p(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,s=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===47){if(!s){i=o;break}}else s=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');p(e);var n=0,i=-1,s=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var l=t.length-1,a=-1;for(o=e.length-1;o>=0;--o){var g=e.charCodeAt(o);if(g===47){if(!s){n=o+1;break}}else a===-1&&(s=!1,a=o+1),l>=0&&(g===t.charCodeAt(l)?--l===-1&&(i=o):(l=-1,i=a))}return n===i?i=a:i===-1&&(i=e.length),e.slice(n,i)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!s){n=o+1;break}}else i===-1&&(s=!1,i=o+1);return i===-1?"":e.slice(n,i)}},extname:function(e){p(e);for(var t=-1,n=0,i=-1,s=!0,o=0,l=e.length-1;l>=0;--l){var a=e.charCodeAt(l);if(a===47){if(!s){n=l+1;break}continue}i===-1&&(s=!1,i=l+1),a===46?t===-1?t=l:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return xe("/",e)},parse:function(e){p(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,s;i?(t.root="/",s=1):s=0;for(var o=-1,l=0,a=-1,g=!0,h=e.length-1,f=0;h>=s;--h){if(n=e.charCodeAt(h),n===47){if(!g){l=h+1;break}continue}a===-1&&(g=!1,a=h+1),n===46?o===-1?o=h:f!==1&&(f=1):o!==-1&&(f=-1)}return o===-1||a===-1||f===0||f===1&&o===a-1&&o===l+1?a!==-1&&(l===0&&i?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(l,a)):(l===0&&i?(t.name=e.slice(1,o),t.base=e.slice(1,a)):(t.name=e.slice(l,o),t.base=e.slice(l,a)),t.ext=e.slice(o,a)),l>0?t.dir=e.slice(0,l-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};b.posix=b;async function Ie(r){await new Promise(e=>setTimeout(e,r))}const z=10,Z=(r=0)=>e=>`\x1B[${e+r}m`,ee=(r=0)=>e=>`\x1B[${38+r};5;${e}m`,te=(r=0)=>(e,t,n)=>`\x1B[${38+r};2;${e};${t};${n}m`,d={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(d.modifier);const we=Object.keys(d.color),Se=Object.keys(d.bgColor);[...we,...Se];function Ae(){const r=new Map;for(const[e,t]of Object.entries(d)){for(const[n,i]of Object.entries(t))d[n]={open:`\x1B[${i[0]}m`,close:`\x1B[${i[1]}m`},t[n]=d[n],r.set(i[0],i[1]);Object.defineProperty(d,e,{value:t,enumerable:!1})}return Object.defineProperty(d,"codes",{value:r,enumerable:!1}),d.color.close="\x1B[39m",d.bgColor.close="\x1B[49m",d.color.ansi=Z(),d.color.ansi256=ee(),d.color.ansi16m=te(),d.bgColor.ansi=Z(z),d.bgColor.ansi256=ee(z),d.bgColor.ansi16m=te(z),Object.defineProperties(d,{rgbToAnsi256:{value(e,t,n){return e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5)},enumerable:!1},hexToRgb:{value(e){const t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!t)return[0,0,0];let[n]=t;n.length===3&&(n=[...n].map(s=>s+s).join(""));const i=Number.parseInt(n,16);return[i>>16&255,i>>8&255,i&255]},enumerable:!1},hexToAnsi256:{value:e=>d.rgbToAnsi256(...d.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){if(e<8)return 30+e;if(e<16)return 90+(e-8);let t,n,i;if(e>=232)t=((e-232)*10+8)/255,n=t,i=t;else{e-=16;const l=e%36;t=Math.floor(e/36)/5,n=Math.floor(l/6)/5,i=l%6/5}const s=Math.max(t,n,i)*2;if(s===0)return 30;let o=30+(Math.round(i)<<2|Math.round(n)<<1|Math.round(t));return s===2&&(o+=60),o},enumerable:!1},rgbToAnsi:{value:(e,t,n)=>d.ansi256ToAnsi(d.rgbToAnsi256(e,t,n)),enumerable:!1},hexToAnsi:{value:e=>d.ansi256ToAnsi(d.hexToAnsi256(e)),enumerable:!1}}),d}const v=Ae(),re=(()=>{if(!("navigator"in globalThis))return 0;if(globalThis.navigator.userAgentData){const r=navigator.userAgentData.brands.find(({brand:e})=>e==="Chromium");if(r&&r.version>93)return 3}return/\b(Chrome|Chromium)\//.test(globalThis.navigator.userAgent)?1:0})(),ne=re!==0&&{level:re},Ce={stdout:ne,stderr:ne};function We(r,e,t){let n=r.indexOf(e);if(n===-1)return r;const i=e.length;let s=0,o="";do o+=r.slice(s,n)+e+t,s=n+i,n=r.indexOf(e,s);while(n!==-1);return o+=r.slice(s),o}function Be(r,e,t,n){let i=0,s="";do{const o=r[n-1]==="\r";s+=r.slice(i,o?n-1:n)+e+(o?`\r
`:`
`)+t,i=n+1,n=r.indexOf(`
`,i)}while(n!==-1);return s+=r.slice(i),s}const{stdout:ie,stderr:se}=Ce,j=Symbol("GENERATOR"),w=Symbol("STYLER"),B=Symbol("IS_EMPTY"),oe=["ansi","ansi","ansi256","ansi16m"],S=Object.create(null),Me=(r,e={})=>{if(e.level&&!(Number.isInteger(e.level)&&e.level>=0&&e.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const t=ie?ie.level:0;r.level=e.level===void 0?t:e.level},Oe=r=>{const e=(...t)=>t.join(" ");return Me(e,r),Object.setPrototypeOf(e,M.prototype),e};function M(r){return Oe(r)}Object.setPrototypeOf(M.prototype,Function.prototype);for(const[r,e]of Object.entries(v))S[r]={get(){const t=E(this,U(e.open,e.close,this[w]),this[B]);return Object.defineProperty(this,r,{value:t}),t}};S.visible={get(){const r=E(this,this[w],!0);return Object.defineProperty(this,"visible",{value:r}),r}};const D=(r,e,t,...n)=>r==="rgb"?e==="ansi16m"?v[t].ansi16m(...n):e==="ansi256"?v[t].ansi256(v.rgbToAnsi256(...n)):v[t].ansi(v.rgbToAnsi(...n)):r==="hex"?D("rgb",e,t,...v.hexToRgb(...n)):v[t][r](...n),Ge=["rgb","hex","ansi256"];for(const r of Ge){S[r]={get(){const{level:t}=this;return function(...n){const i=U(D(r,oe[t],"color",...n),v.color.close,this[w]);return E(this,i,this[B])}}};const e="bg"+r[0].toUpperCase()+r.slice(1);S[e]={get(){const{level:t}=this;return function(...n){const i=U(D(r,oe[t],"bgColor",...n),v.bgColor.close,this[w]);return E(this,i,this[B])}}}}const Re=Object.defineProperties(()=>{},{...S,level:{enumerable:!0,get(){return this[j].level},set(r){this[j].level=r}}}),U=(r,e,t)=>{let n,i;return t===void 0?(n=r,i=e):(n=t.openAll+r,i=e+t.closeAll),{open:r,close:e,openAll:n,closeAll:i,parent:t}},E=(r,e,t)=>{const n=(...i)=>Ee(n,i.length===1?""+i[0]:i.join(" "));return Object.setPrototypeOf(n,Re),n[j]=r,n[w]=e,n[B]=t,n},Ee=(r,e)=>{if(r.level<=0||!e)return r[B]?"":e;let t=r[w];if(t===void 0)return e;const{openAll:n,closeAll:i}=t;if(e.includes("\x1B"))for(;t!==void 0;)e=We(e,t.close,t.open),t=t.parent;const s=e.indexOf(`
`);return s!==-1&&(e=Be(e,i,n,s)),n+e+i};Object.defineProperties(M.prototype,S);const W=M();M({level:se?se.level:0});const $={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},ke={DEBUG:r=>W.gray(r),INFO:r=>r,WARN:r=>W.yellow(r),ERROR:r=>W.red(r),FATAL:r=>W.bgRed(r)};let Y="INFO",le=$[Y];const ze={};class Le{logPrefix="";constructor(e){this.logPrefix=e}static setLogLevel(e){Y=e,le=$[Y]}setLogPrefix=e=>{this.logPrefix=e};log=(e,t,...n)=>{if($[e]<le)return;const i=typeof t=="object",s=i?t.msg:t,o=i?t:ze;let l;e==="DEBUG"||e==="INFO"?l=console.log:e==="WARN"?l=console.warn:e==="ERROR"||e==="FATAL"?l=console.error:l=console.log;const a=ke[e],g=s.split(`
`);for(let h=0;h<g.length;h++)l(a(`${W.bold(e.toLowerCase())}: [${this.logPrefix}] ${g[h]}`));if(n.length>0&&l(...n),o.data!==void 0&&(o.stringifyData?l(JSON.stringify(o.data,null,4)):l(o.data)),o.throw)throw new Error("see previous message")};logDebug=(e,...t)=>{this.log("DEBUG",e,...t)};logInfo=(e,...t)=>{this.log("INFO",e,...t)};logWarn=(e,...t)=>{this.log("WARN",e,...t)};logError=(e,...t)=>{this.log("ERROR",e,...t)};logFatal=(e,...t)=>{this.log("FATAL",e,...t)}}const _e=new Le("lib/spritesheets"),{logFatal:Fe}=_e,Ne=ye;class V{constructor(e,t,n){this._relUrlFilepath=e,this._filename=t,this._image=n}get relUrlFilepath(){return this._relUrlFilepath}get filename(){return this._filename}get image(){return this._image}static async loadDefault(){const e=[];for(const t of Ne){const n=`${pe}/${t.relPath}`,i=fetch(n).then(s=>s.blob()).then(createImageBitmap).then(s=>new V(n,b.parse(t.relPath).base,s)).catch(s=>{throw Fe({msg:"error while loading spritesheets",throw:!0,data:{spritesheet:n,error:s}}),""});e.push(i),await Ie(25)}return Promise.all(e)}convertSsIndexToTilePosition(e){return this.assertSsIndexWithinSpritesheet(e),N(e,R.w)}calculateSpritesheetTileRegion(e){const t=ge[e],n=this.convertSsIndexToSsTilePosition(t);return{x:n.x*C,y:n.y*C,w:C,h:C}}convertCardinalNeighborsToTiling(e){let t=c.none;for(const[n,i]of Object.entries(e))i!==void 0&&(t|=c[n]);return t}convertSsIndexToSsTilePosition(e){return N(e,R.w)}isSsIndexWithinSpritesheet(e){return e<F}assertSsIndexWithinSpritesheet(e){if(!this.isSsIndexWithinSpritesheet(e))throw new Error("failed assert assertSsIndexWithinSpritesheet: "+e)}}function je(r,e){return Array.isArray(r)?(e=r[1],r=r[0]):e===void 0&&(e=r,r=0),r+Math.random()*(e-r)}function De(...r){return Math.round(je.apply(null,r))}function Ue(r){return r.length>0?De(r.length-1):-1}function $e(r){return r[Ue(r)]}const Ye="https://murolem.github.io/ostranauts_funsies/sprite-test/app/assets/trash-bin-black-Bnsn3vaF.png",He="https://murolem.github.io/ostranauts_funsies/sprite-test/app/assets/paint-brush-black-DGHBLeNn.png",qe="https://murolem.github.io/ostranauts_funsies/sprite-test/app/assets/eraser-black-DRmb9ui2.png",G="toggled";function O(r){var e=document.createElement("div");return e.innerHTML=r.trim(),e.firstChild}function Ve(){return O('<button class="simple-button"></button>')}function ae(){const r=O('<button class="toggle-button"></button>');return r.addEventListener("click",()=>r.classList.toggle(G)),r}function L(r,{invert:e=!1}={}){return O(`<img src="${r}" class="icon${e?" invert":""}">`)}function Xe(){return O("<div></div>")}function ce(r,e){const t=Xe();return t.classList.add("button-section",`name-${r}`),t.append(...e),t}function Je(r,e){const t=O('<div class="gui-container dock-top"></div>'),n=Ve();n.appendChild(L(Ye,{invert:!0})),n.addEventListener("click",h=>e.reload?.(h.target));let i=null;const s=h=>{i&&i!==h&&i.classList.contains(G)&&i.click(),i=h},o=ae();o.appendChild(L(He,{invert:!0})),o.addEventListener("click",h=>{const f=h.target;f.classList.contains(G)&&e.selectTool?.(f,"brush"),s(f)}),o.click();const l=ae();l.appendChild(L(qe,{invert:!0})),l.addEventListener("click",h=>{const f=h.target;f.classList.contains(G)&&e.selectTool?.(h.target,"eraser"),s(f)});const a=ce("reload",[n]),g=ce("tools",[o,l]);t.append(a,g),r.parentElement.append(t)}if(Object.keys(_).length!==F)throw new Error(`mismatch between configuring spritesheet size and tiles and defined mappings: ss size set to ${F} tiles, while index mappings configured for ${Object.keys(_).length} tiles`);const P=me(document.getElementById("canvas"),"canvas element not found");if(P.tagName!=="CANVAS")throw new Error("canvas element is not a canvas element, found: "+P.tagName);const T=P.getContext("2d");if(!T)throw new Error("2d rendering context unsupported");const Ke=await V.loadDefault(),x=new Te(P,T),H=new Pe(x,$e(Ke));let X=!1,q={x:0,y:0};P.addEventListener("mousedown",()=>X=!0);P.addEventListener("mouseup",()=>X=!1);P.addEventListener("mousemove",r=>{q.x=r.offsetX-I,q.y=r.offsetY-I});Je(P,{reload:r=>{x.clear()},selectTool:(r,e)=>{H.setMode(e)},selectTileset:(r,e)=>{}});function de(){if(T.save(),T.translate(I,I),T.imageSmoothingEnabled=!1,T.fillStyle="hsl(0, 0%, 15%)",T.fillRect(0,0,x.sizePixelsPadded.w,x.sizePixelsPadded.h),X){const r=x.convertPxPositionToTilePos(q);H.applyAt(r)}x.draw(H),T.restore(),requestAnimationFrame(de)}de();
