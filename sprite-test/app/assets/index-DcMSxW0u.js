(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function he(i,e,t){let r=i[e];return r||(r=t(),i[e]=r),r}const h={none:0,left:1,up:2,right:4,down:8},E={0:h.right|h.down,1:h.left|h.down|h.right,2:h.left|h.down,3:h.up,4:h.up|h.right|h.down,5:h.left|h.up|h.right|h.down,6:h.up|h.left|h.down,7:h.right,8:h.up|h.right,9:h.left|h.up|h.right,10:h.up|h.left,11:h.left,12:h.left|h.right,13:h.none,14:h.up|h.down,15:h.down},ce=Object.entries(E).reduce((i,[e,t])=>{if(he(i,t,()=>parseInt(e))!=parseInt(e))throw new Error("failed to create tiling mapping: found a duplicate tiling rule: "+t.toString(2));return i},{}),oe={left:{x:-1,y:0},up:{x:0,y:-1},right:{x:1,y:0},down:{x:0,y:1}};function de(i,e){if(i==null)throw new Error(e);return i}const A=16,fe=3,M=Object.freeze({w:4,h:4}),H=50,T=100,ue="/spritesheets",F=M.w*M.h,u=A*fe;function ge(i,e){return e*i.y+i.x}function _(i,e){const t=Math.floor(i/e);return{x:i-e*t,y:t}}function V(i,e,t){return Math.max(Math.min(i,t),e)}function z(i,e,t){return i>=e&&i<=t}class me{constructor(e,t){this._canvas=e,this._ctx=t,this._sizeTiles=Object.freeze({w:Math.floor((window.innerWidth-H*2-T*2)/u),h:Math.floor((window.innerHeight-H*2-T*2)/u)}),this._sizePixelsPadded=Object.freeze({w:this.sizeTiles.w*u,h:this.sizeTiles.h*u}),this._sizePixelsUnpadded=Object.freeze({w:this.sizePixelsPadded.w+T*2,h:this.sizePixelsPadded.h+T*2}),e.width=this.sizePixelsUnpadded.w,e.height=this.sizePixelsUnpadded.h}get sizeTiles(){return this._sizeTiles}_sizeTiles;get sizePixelsPadded(){return this._sizePixelsPadded}_sizePixelsPadded;get sizePixelsUnpadded(){return this._sizePixelsUnpadded}_sizePixelsUnpadded;_grid={};convertPxPositionToTilePos(e){return{x:V(Math.floor(e.x/u),0,this.sizeTiles.w),y:V(Math.floor(e.y/u),0,this.sizeTiles.h)}}convertTilePositionToTileGridIndex(e){return ge(e,this.sizeTiles.w)}convertTileGridIndexToTilePosition(e){return _(e,this.sizeTiles.w)}get(e){const t=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e);return this._grid[t]}getCardinalNeighbors(e){const t={left:void 0,up:void 0,right:void 0,down:void 0};for(const[r,n]of Object.entries(oe)){const s=r,o={x:e.x+n.x,y:e.y+n.y};this.isTilePositionWithinGrid(o)&&(t[s]=this.get(o))}return t}set(e,t){const r=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e),n=t;this.assertGridIndexWithinGrid(r),this._grid[r]=n}hasAt(e){const t=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e);return this.assertGridIndexWithinGrid(t),this._grid[t]!==void 0}draw(e){const t=this._ctx;t.strokeStyle="hsl(0, 0%, 20%)";for(let r=0;r<=this.sizeTiles.w;r++){const n={x:u*r,y:0},s={x:u*r,y:this.sizePixelsPadded.h};t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(s.x,s.y),t.stroke()}for(let r=0;r<=this.sizeTiles.h;r++){const n={x:0,y:u*r},s={x:this.sizePixelsPadded.w,y:u*r};t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(s.x,s.y),t.stroke()}for(let[r,n]of Object.entries(this._grid)){const s=parseInt(r),o=this.convertTileGridIndexToTilePosition(s),l={x:o.x*u,y:o.y*u},a=e.tileset.calculateSpritesheetTileRegion(n);t.drawImage(e.tileset.image,a.x,a.y,a.w,a.h,l.x,l.y,u,u)}}isTilePositionWithinGrid(e){return z(e.x,0,this.sizeTiles.w-1)&&z(e.y,0,this.sizeTiles.h-1)}isGridIndexWithinGrid(e){return z(e,0,this.sizeTiles.w*this.sizeTiles.h)}assertTilePositionWithinGrid(e){if(!this.isTilePositionWithinGrid(e))throw new Error("failed assert assertIsTilePositionWithinGrid: "+e)}assertGridIndexWithinGrid(e){if(!this.isGridIndexWithinGrid(e))throw new Error("failed assert assertGridIndexWithinGrid: "+e)}}class be{constructor(e,t){this._grid=e,this._tileset=t}get tileset(){return this._tileset}setTileset(e){this._tileset=e}paint(e){if(!this._grid.isTilePositionWithinGrid(e)||this._grid.hasAt(e))return;const t=this._grid.getCardinalNeighbors(e),r=this._tileset.convertCardinalNeighborsToTiling(t);this._grid.set(e,r);for(const[n,s]of Object.entries(t)){const o=n;if(s===void 0)continue;const l=oe[o],a={x:e.x+l.x,y:e.y+l.y},g=this._grid.getCardinalNeighbors(a),f=this._tileset.convertCardinalNeighborsToTiling(g);this._grid.set(a,f)}}}const ve=[{relPath:"ItmSealTemp01Sheet.png"},{relPath:"ItmWallBlueCaution01Loose.png"},{relPath:"ItmWallBlueCaution01Sheet.png"},{relPath:"ItmWallGrayBevel01Sheet.png"},{relPath:"ItmWallGrayCaution01Sheet.png"},{relPath:"ItmWallGrayPanel01Sheet.png"},{relPath:"ItmWallGreenCross01Sheet.png"},{relPath:"ItmWallGreenRing01Sheet.png"},{relPath:"ItmWallMetalBSheet.png"},{relPath:"ItmWallPanelWSheet.png"},{relPath:"ItmWallPurpleCross01Sheet.png"},{relPath:"ItmWallRedBand01Sheet.png"},{relPath:"ItmWallRedCross01Sheet.png"},{relPath:"ItmWallSheet.png"},{relPath:"ItmWallTanOrange01Sheet.png"},{relPath:"ItmWallThin1x1BlueSheet.png"},{relPath:"ItmWallThin1x1GrayCautionSheet.png"},{relPath:"ItmWallThin1x1GrayCautionSheet02.png"},{relPath:"ItmWallThin1x1GraySheet.png"},{relPath:"ItmWallThin1x1GreenSheet.png"},{relPath:"ItmWallThin1x1OrangeSheet.png"},{relPath:"ItmWallThin1x1RedSheet.png"},{relPath:"ItmWallThin1x1YellowSheet.png"},{relPath:"ItmWallWhiteCross01Sheet.png"},{relPath:"ItmWallWindowSheet.png"},{relPath:"ItmWallWindowSheetSq.png"},{relPath:"ItmWallYellowCaution01Sheet.png"},{relPath:"AeroParts/ItmWallAeroSheet.png"},{relPath:"AeroParts/ItmWallAeroSheetSq.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroExtWhite01Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt01Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt02Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt03Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt04Sheet.png"},{relPath:"Meat01/ItmMeat01EyeSheet.png"},{relPath:"Meat01/ItmMeat01HoofSheet.png"},{relPath:"Meat01/ItmMeat01HornSheet.png"},{relPath:"Meat01/ItmMeat01Sheet.png"}];function v(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function X(i,e){for(var t="",r=0,n=-1,s=0,o,l=0;l<=i.length;++l){if(l<i.length)o=i.charCodeAt(l);else{if(o===47)break;o=47}if(o===47){if(!(n===l-1||s===1))if(n!==l-1&&s===2){if(t.length<2||r!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var a=t.lastIndexOf("/");if(a!==t.length-1){a===-1?(t="",r=0):(t=t.slice(0,a),r=t.length-1-t.lastIndexOf("/")),n=l,s=0;continue}}else if(t.length===2||t.length===1){t="",r=0,n=l,s=0;continue}}e&&(t.length>0?t+="/..":t="..",r=2)}else t.length>0?t+="/"+i.slice(n+1,l):t=i.slice(n+1,l),r=l-n-1;n=l,s=0}else o===46&&s!==-1?++s:s=-1}return t}function pe(i,e){var t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+r:t+i+r:r}var m={process_cwd:"",setCWD:function(e){m.process_cwd=e},resolve:function(){for(var e="",t=!1,r,n=arguments.length-1;n>=-1&&!t;n--){var s;n>=0?s=arguments[n]:(r===void 0&&(r=m.process_cwd),s=r),v(s),s.length!==0&&s+"/"!==e&&(e=s+"/"+e,t=s.charCodeAt(0)===47)}return e=X(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(v(e),e.length===0)return".";var t=e.charCodeAt(0)===47,r=e.charCodeAt(e.length-1)===47;return e=X(e,!t),e.length===0&&!t&&(e="."),e.length>0&&r&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return v(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var r=arguments[t];v(r),r.length>0&&(e===void 0?e=r:e+="/"+r)}return e===void 0?".":m.normalize(e)},relative:function(e,t){if(v(e),v(t),e===t)return"";const r=e.replaceAll("\\","/"),n=t.replaceAll("\\","/");if(r!=e&&n!=t)return m.relative(r,n).replaceAll("/","\\");if(r!=e)return m.relative(r,t).replaceAll("/","\\");if(n!=t)return m.relative(e,n);if(e=m.resolve(e),t=m.resolve(t),e===t)return"";for(var s=1;s<e.length&&e.charCodeAt(s)===47;++s);for(var o=e.length,l=o-s,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var g=t.length,f=g-a,b=l<f?l:f,x=-1,d=0;d<=b;++d){if(d===b){if(f>b){if(t.charCodeAt(a+d)===47)return t.slice(a+d+1);if(d===0)return t.slice(a+d)}else l>b&&(e.charCodeAt(s+d)===47?x=d:d===0&&(x=0));break}var q=e.charCodeAt(s+d),ae=t.charCodeAt(a+d);if(q!==ae)break;q===47&&(x=d)}var S="";for(d=s+x+1;d<=o;++d)(d===o||e.charCodeAt(d)===47)&&(S.length===0?S+="..":S+="/..");return S.length>0?S+t.slice(a+x):(a+=x,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(v(e),e.length===0)return".";for(var t=e.charCodeAt(0),r=t===47,n=-1,s=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===47){if(!s){n=o;break}}else s=!1;return n===-1?r?"/":".":r&&n===1?"//":e.slice(0,n)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');v(e);var r=0,n=-1,s=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var l=t.length-1,a=-1;for(o=e.length-1;o>=0;--o){var g=e.charCodeAt(o);if(g===47){if(!s){r=o+1;break}}else a===-1&&(s=!1,a=o+1),l>=0&&(g===t.charCodeAt(l)?--l===-1&&(n=o):(l=-1,n=a))}return r===n?n=a:n===-1&&(n=e.length),e.slice(r,n)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!s){r=o+1;break}}else n===-1&&(s=!1,n=o+1);return n===-1?"":e.slice(r,n)}},extname:function(e){v(e);for(var t=-1,r=0,n=-1,s=!0,o=0,l=e.length-1;l>=0;--l){var a=e.charCodeAt(l);if(a===47){if(!s){r=l+1;break}continue}n===-1&&(s=!1,n=l+1),a===46?t===-1?t=l:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return pe("/",e)},parse:function(e){v(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var r=e.charCodeAt(0),n=r===47,s;n?(t.root="/",s=1):s=0;for(var o=-1,l=0,a=-1,g=!0,f=e.length-1,b=0;f>=s;--f){if(r=e.charCodeAt(f),r===47){if(!g){l=f+1;break}continue}a===-1&&(g=!1,a=f+1),r===46?o===-1?o=f:b!==1&&(b=1):o!==-1&&(b=-1)}return o===-1||a===-1||b===0||b===1&&o===a-1&&o===l+1?a!==-1&&(l===0&&n?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(l,a)):(l===0&&n?(t.name=e.slice(1,o),t.base=e.slice(1,a)):(t.name=e.slice(l,o),t.base=e.slice(l,a)),t.ext=e.slice(o,a)),l>0?t.dir=e.slice(0,l-1):n&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};m.posix=m;async function Pe(i){await new Promise(e=>setTimeout(e,i))}const B=10,J=(i=0)=>e=>`\x1B[${e+i}m`,K=(i=0)=>e=>`\x1B[${38+i};5;${e}m`,Q=(i=0)=>(e,t,r)=>`\x1B[${38+i};2;${e};${t};${r}m`,c={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(c.modifier);const Te=Object.keys(c.color),ye=Object.keys(c.bgColor);[...Te,...ye];function xe(){const i=new Map;for(const[e,t]of Object.entries(c)){for(const[r,n]of Object.entries(t))c[r]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},t[r]=c[r],i.set(n[0],n[1]);Object.defineProperty(c,e,{value:t,enumerable:!1})}return Object.defineProperty(c,"codes",{value:i,enumerable:!1}),c.color.close="\x1B[39m",c.bgColor.close="\x1B[49m",c.color.ansi=J(),c.color.ansi256=K(),c.color.ansi16m=Q(),c.bgColor.ansi=J(B),c.bgColor.ansi256=K(B),c.bgColor.ansi16m=Q(B),Object.defineProperties(c,{rgbToAnsi256:{value(e,t,r){return e===t&&t===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(r/255*5)},enumerable:!1},hexToRgb:{value(e){const t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!t)return[0,0,0];let[r]=t;r.length===3&&(r=[...r].map(s=>s+s).join(""));const n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:e=>c.rgbToAnsi256(...c.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){if(e<8)return 30+e;if(e<16)return 90+(e-8);let t,r,n;if(e>=232)t=((e-232)*10+8)/255,r=t,n=t;else{e-=16;const l=e%36;t=Math.floor(e/36)/5,r=Math.floor(l/6)/5,n=l%6/5}const s=Math.max(t,r,n)*2;if(s===0)return 30;let o=30+(Math.round(n)<<2|Math.round(r)<<1|Math.round(t));return s===2&&(o+=60),o},enumerable:!1},rgbToAnsi:{value:(e,t,r)=>c.ansi256ToAnsi(c.rgbToAnsi256(e,t,r)),enumerable:!1},hexToAnsi:{value:e=>c.ansi256ToAnsi(c.hexToAnsi256(e)),enumerable:!1}}),c}const p=xe(),Z=(()=>{if(!("navigator"in globalThis))return 0;if(globalThis.navigator.userAgentData){const i=navigator.userAgentData.brands.find(({brand:e})=>e==="Chromium");if(i&&i.version>93)return 3}return/\b(Chrome|Chromium)\//.test(globalThis.navigator.userAgent)?1:0})(),ee=Z!==0&&{level:Z},we={stdout:ee,stderr:ee};function Ie(i,e,t){let r=i.indexOf(e);if(r===-1)return i;const n=e.length;let s=0,o="";do o+=i.slice(s,r)+e+t,s=r+n,r=i.indexOf(e,s);while(r!==-1);return o+=i.slice(s),o}function Se(i,e,t,r){let n=0,s="";do{const o=i[r-1]==="\r";s+=i.slice(n,o?r-1:r)+e+(o?`\r
`:`
`)+t,n=r+1,r=i.indexOf(`
`,n)}while(r!==-1);return s+=i.slice(n),s}const{stdout:te,stderr:re}=we,N=Symbol("GENERATOR"),w=Symbol("STYLER"),O=Symbol("IS_EMPTY"),ie=["ansi","ansi","ansi256","ansi16m"],I=Object.create(null),Ae=(i,e={})=>{if(e.level&&!(Number.isInteger(e.level)&&e.level>=0&&e.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const t=te?te.level:0;i.level=e.level===void 0?t:e.level},Ce=i=>{const e=(...t)=>t.join(" ");return Ae(e,i),Object.setPrototypeOf(e,G.prototype),e};function G(i){return Ce(i)}Object.setPrototypeOf(G.prototype,Function.prototype);for(const[i,e]of Object.entries(p))I[i]={get(){const t=R(this,j(e.open,e.close,this[w]),this[O]);return Object.defineProperty(this,i,{value:t}),t}};I.visible={get(){const i=R(this,this[w],!0);return Object.defineProperty(this,"visible",{value:i}),i}};const L=(i,e,t,...r)=>i==="rgb"?e==="ansi16m"?p[t].ansi16m(...r):e==="ansi256"?p[t].ansi256(p.rgbToAnsi256(...r)):p[t].ansi(p.rgbToAnsi(...r)):i==="hex"?L("rgb",e,t,...p.hexToRgb(...r)):p[t][i](...r),We=["rgb","hex","ansi256"];for(const i of We){I[i]={get(){const{level:t}=this;return function(...r){const n=j(L(i,ie[t],"color",...r),p.color.close,this[w]);return R(this,n,this[O])}}};const e="bg"+i[0].toUpperCase()+i.slice(1);I[e]={get(){const{level:t}=this;return function(...r){const n=j(L(i,ie[t],"bgColor",...r),p.bgColor.close,this[w]);return R(this,n,this[O])}}}}const Oe=Object.defineProperties(()=>{},{...I,level:{enumerable:!0,get(){return this[N].level},set(i){this[N].level=i}}}),j=(i,e,t)=>{let r,n;return t===void 0?(r=i,n=e):(r=t.openAll+i,n=e+t.closeAll),{open:i,close:e,openAll:r,closeAll:n,parent:t}},R=(i,e,t)=>{const r=(...n)=>Ge(r,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(r,Oe),r[N]=i,r[w]=e,r[O]=t,r},Ge=(i,e)=>{if(i.level<=0||!e)return i[O]?"":e;let t=i[w];if(t===void 0)return e;const{openAll:r,closeAll:n}=t;if(e.includes("\x1B"))for(;t!==void 0;)e=Ie(e,t.close,t.open),t=t.parent;const s=e.indexOf(`
`);return s!==-1&&(e=Se(e,n,r,s)),r+e+n};Object.defineProperties(G.prototype,I);const C=G();G({level:re?re.level:0});const k={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},Me={DEBUG:i=>C.gray(i),INFO:i=>i,WARN:i=>C.yellow(i),ERROR:i=>C.red(i),FATAL:i=>C.bgRed(i)};let D="INFO",ne=k[D];const Re={};class ze{logPrefix="";constructor(e){this.logPrefix=e}static setLogLevel(e){D=e,ne=k[D]}setLogPrefix=e=>{this.logPrefix=e};log=(e,t,...r)=>{if(k[e]<ne)return;const n=typeof t=="object",s=n?t.msg:t,o=n?t:Re;let l;e==="DEBUG"||e==="INFO"?l=console.log:e==="WARN"?l=console.warn:e==="ERROR"||e==="FATAL"?l=console.error:l=console.log;const a=Me[e],g=s.split(`
`);for(let f=0;f<g.length;f++)l(a(`${C.bold(e.toLowerCase())}: [${this.logPrefix}] ${g[f]}`));if(r.length>0&&l(...r),o.data!==void 0&&(o.stringifyData?l(JSON.stringify(o.data,null,4)):l(o.data)),o.throw)throw new Error("see previous message")};logDebug=(e,...t)=>{this.log("DEBUG",e,...t)};logInfo=(e,...t)=>{this.log("INFO",e,...t)};logWarn=(e,...t)=>{this.log("WARN",e,...t)};logError=(e,...t)=>{this.log("ERROR",e,...t)};logFatal=(e,...t)=>{this.log("FATAL",e,...t)}}const Be=new ze("lib/spritesheets"),{logFatal:Ee}=Be,Fe=ve;class ${constructor(e,t,r){this._relUrlFilepath=e,this._filename=t,this._image=r}get relUrlFilepath(){return this._relUrlFilepath}get filename(){return this._filename}get image(){return this._image}static async loadDefault(){const e=[];for(const t of Fe){const r=`${ue}/${t.relPath}`,n=fetch(r).then(s=>s.blob()).then(createImageBitmap).then(s=>new $(r,m.parse(t.relPath).base,s)).catch(s=>{throw Ee({msg:"error while loading spritesheets",throw:!0,data:{spritesheet:r,error:s}}),""});e.push(n),await Pe(25)}return Promise.all(e)}convertSsIndexToTilePosition(e){return this.assertSsIndexWithinSpritesheet(e),_(e,M.w)}calculateSpritesheetTileRegion(e){const t=ce[e],r=this.convertSsIndexToSsTilePosition(t);return{x:r.x*A,y:r.y*A,w:A,h:A}}convertCardinalNeighborsToTiling(e){let t=h.none;for(const[r,n]of Object.entries(e))n!==void 0&&(t|=h[r]);return t}convertSsIndexToSsTilePosition(e){return _(e,M.w)}isSsIndexWithinSpritesheet(e){return e<F}assertSsIndexWithinSpritesheet(e){if(!this.isSsIndexWithinSpritesheet(e))throw new Error("failed assert assertSsIndexWithinSpritesheet: "+e)}}function _e(i,e){return Array.isArray(i)?(e=i[1],i=i[0]):e===void 0&&(e=i,i=0),i+Math.random()*(e-i)}function Ne(...i){return Math.round(_e.apply(null,i))}function Le(i){return i.length>0?Ne(i.length-1):-1}function je(i){return i[Le(i)]}if(Object.keys(E).length!==F)throw new Error(`mismatch between configuring spritesheet size and tiles and defined mappings: ss size set to ${F} tiles, while index mappings configured for ${Object.keys(E).length} tiles`);const y=de(document.getElementById("canvas"),"canvas element not found");if(y.tagName!=="CANVAS")throw new Error("canvas element is not a canvas element, found: "+y.tagName);const P=y.getContext("2d");if(!P)throw new Error("2d rendering context unsupported");const ke=await $.loadDefault(),W=new me(y,P),se=new be(W,je(ke));let Y=!1,U={x:0,y:0};y.addEventListener("mousedown",()=>Y=!0);y.addEventListener("mouseup",()=>Y=!1);y.addEventListener("mousemove",i=>{U.x=i.offsetX-T,U.y=i.offsetY-T});function le(){if(P.save(),P.translate(T,T),P.imageSmoothingEnabled=!1,P.fillStyle="hsl(0, 0%, 15%)",P.fillRect(0,0,W.sizePixelsPadded.w,W.sizePixelsPadded.h),Y){const i=W.convertPxPositionToTilePos(U);se.paint(i)}W.draw(se),P.restore(),requestAnimationFrame(le)}le();
