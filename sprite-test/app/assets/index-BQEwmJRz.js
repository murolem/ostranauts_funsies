(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Pe(r,e,t){let n=r[e];return n||(n=t(),r[e]=n),n}const c={none:0,left:1,up:2,right:4,down:8},$={0:c.right|c.down,1:c.left|c.down|c.right,2:c.left|c.down,3:c.up,4:c.up|c.right|c.down,5:c.left|c.up|c.right|c.down,6:c.up|c.left|c.down,7:c.right,8:c.up|c.right,9:c.left|c.up|c.right,10:c.up|c.left,11:c.left,12:c.left|c.right,13:c.none,14:c.up|c.down,15:c.down},we=Object.entries($).reduce((r,[e,t])=>{if(Pe(r,t,()=>parseInt(e))!=parseInt(e))throw new Error("failed to create tiling mapping: found a duplicate tiling rule: "+t.toString(2));return r},{}),be={left:{x:-1,y:0},up:{x:0,y:-1},right:{x:1,y:0},down:{x:0,y:1}};function Se(r,e){if(r==null)throw new Error(e);return r}const k=16,xe=3,O=Object.freeze({w:4,h:4}),I=0,Ae="spritesheets",K=O.w*O.h,p=k*xe;function Ie(r,e){return e*r.y+r.x}function Y(r,e){const t=Math.floor(r/e);return{x:r-e*t,y:t}}function Ce(r,e,t){return Math.max(Math.min(r,t),e)}function ie(r,e){for(var t=1,n=r-e+1;n<=r;n++)t*=n;for(var n=1;n<=e;n++)t/=n;return t}function We(r,e){var t=e.length-1,n=0,i=0;for(let s=0;s<=t;s++)i=i+ie(t,s)*Math.pow(1-r,t-s)*Math.pow(r,s)*e[s].x,n=n+ie(t,s)*Math.pow(1-r,t-s)*Math.pow(r,s)*e[s].y;return n}function ke(r){let e=r.split(`
`);e=e.slice(1,e.length-1);const t=e.reduce((o,l)=>l.length>o?l.length:o,0),n=1/t,i=1/e.length,s=[];for(let o=0;o<t;o++){for(const[l,a]of e.entries()){const u=a[o];if(u!==void 0&&u!==" "){const h={x:o*n,y:(e.length-l)*i};s.push(h);continue}}[...e.entries()].find(([l,a])=>{const u=a[o];return u!==void 0&&u!==" "})}return function(o){return We(o,s)}}function F(r,e,t){return r>=e&&r<=t}class Me{constructor(e,t){this._canvas=e,this._ctx=t,this._sizeTiles=Object.freeze({w:Math.floor(e.clientWidth/p),h:Math.floor(e.clientHeight/p)}),this._sizePixelsPadded=Object.freeze({w:this.sizeTiles.w*p,h:this.sizeTiles.h*p}),this._sizePixelsUnpadded=Object.freeze({w:this.sizePixelsPadded.w+I*2,h:this.sizePixelsPadded.h+I*2}),e.width=this.sizePixelsUnpadded.w,e.height=this.sizePixelsUnpadded.h}get sizeTiles(){return this._sizeTiles}_sizeTiles;get sizePixelsPadded(){return this._sizePixelsPadded}_sizePixelsPadded;get sizePixelsUnpadded(){return this._sizePixelsUnpadded}_sizePixelsUnpadded;_grid={};_scheduledClearDurationMs=150;_clearScheduleAtTs=null;_sampleClearCurve=ke(`
                                                                                        X       x
                                                                 
                                                X
                                        
                                
x             x
`);convertPxPositionToTilePos(e){return{x:Math.floor(e.x/p),y:Math.floor(e.y/p)}}convertTilePositionToTileGridIndex(e){return Ie(e,this.sizeTiles.w)}convertTileGridIndexToTilePosition(e){return Y(e,this.sizeTiles.w)}get(e){const t=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e);return this._grid[t]}getCardinalNeighbors(e){const t={left:void 0,up:void 0,right:void 0,down:void 0};for(const[n,i]of Object.entries(be)){const s=n,o={x:e.x+i.x,y:e.y+i.y};this.isTilePositionWithinGrid(o)&&(t[s]=this.get(o))}return t}set(e,t){const n=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e),i=t;this.assertGridIndexWithinGrid(n),i===void 0?delete this._grid[n]:this._grid[n]=i}hasAt(e){const t=typeof e=="number"?e:this.convertTilePositionToTileGridIndex(e);return this.assertGridIndexWithinGrid(t),this._grid[t]!==void 0}draw(e){this._tryScheduledClearIfAny();const t=this._ctx;t.strokeStyle="hsl(0, 0%, 20%)";for(let o=0;o<=this.sizeTiles.w;o++){const l={x:p*o,y:0},a={x:p*o,y:this.sizePixelsPadded.h};t.beginPath(),t.moveTo(l.x,l.y),t.lineTo(a.x,a.y),t.stroke()}for(let o=0;o<=this.sizeTiles.h;o++){const l={x:0,y:p*o},a={x:this.sizePixelsPadded.w,y:p*o};t.beginPath(),t.moveTo(l.x,l.y),t.lineTo(a.x,a.y),t.stroke()}const n=this._isClearScheduled();let i=0,s=0;if(n){const o=this._getScheduledClearProgress();i=this._sampleClearCurve(o),s=p/2*i}for(let[o,l]of Object.entries(this._grid)){if(l===void 0)continue;const a=parseInt(o),u=this.convertTileGridIndexToTilePosition(a),h={x:u.x*p,y:u.y*p},m=e.tileset.calculateSpritesheetTileRegion(l);t.save(),t.translate(h.x,h.y),n&&(t.translate(s,s),t.scale(1-i,1-i)),t.drawImage(e.tileset.image,m.x,m.y,m.w,m.h,0,0,p,p),t.restore()}}clear(){this._isClearScheduled()||(this._clearScheduleAtTs=Date.now()+this._scheduledClearDurationMs)}_tryScheduledClearIfAny(){this._isClearScheduled()&&this._clearScheduleAtTs<=Date.now()&&(this._grid={},this._clearScheduleAtTs=null)}_getScheduledClearProgress(){if(!this._isClearScheduled())return 0;const t=1-(this._clearScheduleAtTs-Date.now())/this._scheduledClearDurationMs;return Ce(t,0,1)}_isClearScheduled(){return this._clearScheduleAtTs!==null}isTilePositionWithinGrid(e){return F(e.x,0,this.sizeTiles.w-1)&&F(e.y,0,this.sizeTiles.h-1)}isGridIndexWithinGrid(e){return F(e,0,this.sizeTiles.w*this.sizeTiles.h)}assertTilePositionWithinGrid(e){if(!this.isTilePositionWithinGrid(e))throw new Error("failed assert assertIsTilePositionWithinGrid: "+e)}assertGridIndexWithinGrid(e){if(!this.isGridIndexWithinGrid(e))throw new Error("failed assert assertGridIndexWithinGrid: "+e)}}class Be{constructor(e,t){this._grid=e,this._tileset=t}get tileset(){return this._tileset}mode="brush";setTileset(e){this._tileset=e}setMode(e){this.mode=e}tryApplyAt(e){if(!this._grid.isTilePositionWithinGrid(e))return;const t=this._grid.getCardinalNeighbors(e);switch(this.mode){case"brush":this.applyBrushMode(e,t);break;case"eraser":this.applyEraserMode(e);break;default:throw new Error("not impl brush mode: "+this.mode)}for(const[n,i]of Object.entries(t)){const s=n;if(i===void 0)continue;const o=be[s],l={x:e.x+o.x,y:e.y+o.y},a=this._grid.getCardinalNeighbors(l),u=this._tileset.convertCardinalNeighborsToTiling(a);this._grid.set(l,u)}}applyBrushMode(e,t){if(this._grid.hasAt(e))return;const n=this._tileset.convertCardinalNeighborsToTiling(t);this._grid.set(e,n)}applyEraserMode(e){this._grid.hasAt(e)&&this._grid.set(e,void 0)}}const _e=[{relPath:"ItmSealTemp01Sheet.png"},{relPath:"ItmWallBlueCaution01Loose.png"},{relPath:"ItmWallBlueCaution01Sheet.png"},{relPath:"ItmWallGrayBevel01Sheet.png"},{relPath:"ItmWallGrayCaution01Sheet.png"},{relPath:"ItmWallGrayPanel01Sheet.png"},{relPath:"ItmWallGreenCross01Sheet.png"},{relPath:"ItmWallGreenRing01Sheet.png"},{relPath:"ItmWallMetalBSheet.png"},{relPath:"ItmWallPanelWSheet.png"},{relPath:"ItmWallPurpleCross01Sheet.png"},{relPath:"ItmWallRedBand01Sheet.png"},{relPath:"ItmWallRedCross01Sheet.png"},{relPath:"ItmWallSheet.png"},{relPath:"ItmWallTanOrange01Sheet.png"},{relPath:"ItmWallThin1x1BlueSheet.png"},{relPath:"ItmWallThin1x1GrayCautionSheet.png"},{relPath:"ItmWallThin1x1GrayCautionSheet02.png"},{relPath:"ItmWallThin1x1GraySheet.png"},{relPath:"ItmWallThin1x1GreenSheet.png"},{relPath:"ItmWallThin1x1OrangeSheet.png"},{relPath:"ItmWallThin1x1RedSheet.png"},{relPath:"ItmWallThin1x1YellowSheet.png"},{relPath:"ItmWallWhiteCross01Sheet.png"},{relPath:"ItmWallWindowSheet.png"},{relPath:"ItmWallWindowSheetSq.png"},{relPath:"ItmWallYellowCaution01Sheet.png"},{relPath:"AeroParts/ItmWallAeroSheet.png"},{relPath:"AeroParts/ItmWallAeroSheetSq.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroExtWhite01Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt01Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt02Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt03Sheet.png"},{relPath:"ItmFloorGrate12A/ItmWallAeroInt04Sheet.png"},{relPath:"Meat01/ItmMeat01EyeSheet.png"},{relPath:"Meat01/ItmMeat01HoofSheet.png"},{relPath:"Meat01/ItmMeat01HornSheet.png"},{relPath:"Meat01/ItmMeat01Sheet.png"}];function v(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function se(r,e){for(var t="",n=0,i=-1,s=0,o,l=0;l<=r.length;++l){if(l<r.length)o=r.charCodeAt(l);else{if(o===47)break;o=47}if(o===47){if(!(i===l-1||s===1))if(i!==l-1&&s===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var a=t.lastIndexOf("/");if(a!==t.length-1){a===-1?(t="",n=0):(t=t.slice(0,a),n=t.length-1-t.lastIndexOf("/")),i=l,s=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=l,s=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,l):t=r.slice(i+1,l),n=l-i-1;i=l,s=0}else o===46&&s!==-1?++s:s=-1}return t}function Ee(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var b={process_cwd:"",setCWD:function(e){b.process_cwd=e},resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var s;i>=0?s=arguments[i]:(n===void 0&&(n=b.process_cwd),s=n),v(s),s.length!==0&&s+"/"!==e&&(e=s+"/"+e,t=s.charCodeAt(0)===47)}return e=se(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(v(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=se(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return v(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];v(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":b.normalize(e)},relative:function(e,t){if(v(e),v(t),e===t)return"";const n=e.replaceAll("\\","/"),i=t.replaceAll("\\","/");if(n!=e&&i!=t)return b.relative(n,i).replaceAll("/","\\");if(n!=e)return b.relative(n,t).replaceAll("/","\\");if(i!=t)return b.relative(e,i);if(e=b.resolve(e),t=b.resolve(t),e===t)return"";for(var s=1;s<e.length&&e.charCodeAt(s)===47;++s);for(var o=e.length,l=o-s,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var u=t.length,h=u-a,m=l<h?l:h,T=-1,f=0;f<=m;++f){if(f===m){if(h>m){if(t.charCodeAt(a+f)===47)return t.slice(a+f+1);if(f===0)return t.slice(a+f)}else l>m&&(e.charCodeAt(s+f)===47?T=f:f===0&&(T=0));break}var L=e.charCodeAt(s+f),ne=t.charCodeAt(a+f);if(L!==ne)break;L===47&&(T=f)}var g="";for(f=s+T+1;f<=o;++f)(f===o||e.charCodeAt(f)===47)&&(g.length===0?g+="..":g+="/..");return g.length>0?g+t.slice(a+T):(a+=T,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(v(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,s=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===47){if(!s){i=o;break}}else s=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');v(e);var n=0,i=-1,s=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var l=t.length-1,a=-1;for(o=e.length-1;o>=0;--o){var u=e.charCodeAt(o);if(u===47){if(!s){n=o+1;break}}else a===-1&&(s=!1,a=o+1),l>=0&&(u===t.charCodeAt(l)?--l===-1&&(i=o):(l=-1,i=a))}return n===i?i=a:i===-1&&(i=e.length),e.slice(n,i)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!s){n=o+1;break}}else i===-1&&(s=!1,i=o+1);return i===-1?"":e.slice(n,i)}},extname:function(e){v(e);for(var t=-1,n=0,i=-1,s=!0,o=0,l=e.length-1;l>=0;--l){var a=e.charCodeAt(l);if(a===47){if(!s){n=l+1;break}continue}i===-1&&(s=!1,i=l+1),a===46?t===-1?t=l:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return Ee("/",e)},parse:function(e){v(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,s;i?(t.root="/",s=1):s=0;for(var o=-1,l=0,a=-1,u=!0,h=e.length-1,m=0;h>=s;--h){if(n=e.charCodeAt(h),n===47){if(!u){l=h+1;break}continue}a===-1&&(u=!1,a=h+1),n===46?o===-1?o=h:m!==1&&(m=1):o!==-1&&(m=-1)}return o===-1||a===-1||m===0||m===1&&o===a-1&&o===l+1?a!==-1&&(l===0&&i?t.base=t.name=e.slice(1,a):t.base=t.name=e.slice(l,a)):(l===0&&i?(t.name=e.slice(1,o),t.base=e.slice(1,a)):(t.name=e.slice(l,o),t.base=e.slice(l,a)),t.ext=e.slice(o,a)),l>0?t.dir=e.slice(0,l-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};b.posix=b;async function Le(r){await new Promise(e=>setTimeout(e,r))}const D=10,oe=(r=0)=>e=>`\x1B[${e+r}m`,le=(r=0)=>e=>`\x1B[${38+r};5;${e}m`,ae=(r=0)=>(e,t,n)=>`\x1B[${38+r};2;${e};${t};${n}m`,d={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(d.modifier);const Oe=Object.keys(d.color),Re=Object.keys(d.bgColor);[...Oe,...Re];function Ge(){const r=new Map;for(const[e,t]of Object.entries(d)){for(const[n,i]of Object.entries(t))d[n]={open:`\x1B[${i[0]}m`,close:`\x1B[${i[1]}m`},t[n]=d[n],r.set(i[0],i[1]);Object.defineProperty(d,e,{value:t,enumerable:!1})}return Object.defineProperty(d,"codes",{value:r,enumerable:!1}),d.color.close="\x1B[39m",d.bgColor.close="\x1B[49m",d.color.ansi=oe(),d.color.ansi256=le(),d.color.ansi16m=ae(),d.bgColor.ansi=oe(D),d.bgColor.ansi256=le(D),d.bgColor.ansi16m=ae(D),Object.defineProperties(d,{rgbToAnsi256:{value(e,t,n){return e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5)},enumerable:!1},hexToRgb:{value(e){const t=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!t)return[0,0,0];let[n]=t;n.length===3&&(n=[...n].map(s=>s+s).join(""));const i=Number.parseInt(n,16);return[i>>16&255,i>>8&255,i&255]},enumerable:!1},hexToAnsi256:{value:e=>d.rgbToAnsi256(...d.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){if(e<8)return 30+e;if(e<16)return 90+(e-8);let t,n,i;if(e>=232)t=((e-232)*10+8)/255,n=t,i=t;else{e-=16;const l=e%36;t=Math.floor(e/36)/5,n=Math.floor(l/6)/5,i=l%6/5}const s=Math.max(t,n,i)*2;if(s===0)return 30;let o=30+(Math.round(i)<<2|Math.round(n)<<1|Math.round(t));return s===2&&(o+=60),o},enumerable:!1},rgbToAnsi:{value:(e,t,n)=>d.ansi256ToAnsi(d.rgbToAnsi256(e,t,n)),enumerable:!1},hexToAnsi:{value:e=>d.ansi256ToAnsi(d.hexToAnsi256(e)),enumerable:!1}}),d}const y=Ge(),ce=(()=>{if(!("navigator"in globalThis))return 0;if(globalThis.navigator.userAgentData){const r=navigator.userAgentData.brands.find(({brand:e})=>e==="Chromium");if(r&&r.version>93)return 3}return/\b(Chrome|Chromium)\//.test(globalThis.navigator.userAgent)?1:0})(),de=ce!==0&&{level:ce},ze={stdout:de,stderr:de};function Fe(r,e,t){let n=r.indexOf(e);if(n===-1)return r;const i=e.length;let s=0,o="";do o+=r.slice(s,n)+e+t,s=n+i,n=r.indexOf(e,s);while(n!==-1);return o+=r.slice(s),o}function De(r,e,t,n){let i=0,s="";do{const o=r[n-1]==="\r";s+=r.slice(i,o?n-1:n)+e+(o?`\r
`:`
`)+t,i=n+1,n=r.indexOf(`
`,i)}while(n!==-1);return s+=r.slice(i),s}const{stdout:ue,stderr:he}=ze,H=Symbol("GENERATOR"),C=Symbol("STYLER"),_=Symbol("IS_EMPTY"),fe=["ansi","ansi","ansi256","ansi16m"],W=Object.create(null),Ne=(r,e={})=>{if(e.level&&!(Number.isInteger(e.level)&&e.level>=0&&e.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");const t=ue?ue.level:0;r.level=e.level===void 0?t:e.level},je=r=>{const e=(...t)=>t.join(" ");return Ne(e,r),Object.setPrototypeOf(e,E.prototype),e};function E(r){return je(r)}Object.setPrototypeOf(E.prototype,Function.prototype);for(const[r,e]of Object.entries(y))W[r]={get(){const t=R(this,q(e.open,e.close,this[C]),this[_]);return Object.defineProperty(this,r,{value:t}),t}};W.visible={get(){const r=R(this,this[C],!0);return Object.defineProperty(this,"visible",{value:r}),r}};const X=(r,e,t,...n)=>r==="rgb"?e==="ansi16m"?y[t].ansi16m(...n):e==="ansi256"?y[t].ansi256(y.rgbToAnsi256(...n)):y[t].ansi(y.rgbToAnsi(...n)):r==="hex"?X("rgb",e,t,...y.hexToRgb(...n)):y[t][r](...n),Ue=["rgb","hex","ansi256"];for(const r of Ue){W[r]={get(){const{level:t}=this;return function(...n){const i=q(X(r,fe[t],"color",...n),y.color.close,this[C]);return R(this,i,this[_])}}};const e="bg"+r[0].toUpperCase()+r.slice(1);W[e]={get(){const{level:t}=this;return function(...n){const i=q(X(r,fe[t],"bgColor",...n),y.bgColor.close,this[C]);return R(this,i,this[_])}}}}const $e=Object.defineProperties(()=>{},{...W,level:{enumerable:!0,get(){return this[H].level},set(r){this[H].level=r}}}),q=(r,e,t)=>{let n,i;return t===void 0?(n=r,i=e):(n=t.openAll+r,i=e+t.closeAll),{open:r,close:e,openAll:n,closeAll:i,parent:t}},R=(r,e,t)=>{const n=(...i)=>Ke(n,i.length===1?""+i[0]:i.join(" "));return Object.setPrototypeOf(n,$e),n[H]=r,n[C]=e,n[_]=t,n},Ke=(r,e)=>{if(r.level<=0||!e)return r[_]?"":e;let t=r[C];if(t===void 0)return e;const{openAll:n,closeAll:i}=t;if(e.includes("\x1B"))for(;t!==void 0;)e=Fe(e,t.close,t.open),t=t.parent;const s=e.indexOf(`
`);return s!==-1&&(e=De(e,i,n,s)),n+e+i};Object.defineProperties(E.prototype,W);const M=E();E({level:he?he.level:0});const V={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},Ye={DEBUG:r=>M.gray(r),INFO:r=>r,WARN:r=>M.yellow(r),ERROR:r=>M.red(r),FATAL:r=>M.bgRed(r)};let J="INFO",ge=V[J];const He={};class Xe{logPrefix="";constructor(e){this.logPrefix=e}static setLogLevel(e){J=e,ge=V[J]}setLogPrefix=e=>{this.logPrefix=e};log=(e,t,...n)=>{if(V[e]<ge)return;const i=typeof t=="object",s=i?t.msg:t,o=i?t:He;let l;e==="DEBUG"||e==="INFO"?l=console.log:e==="WARN"?l=console.warn:e==="ERROR"||e==="FATAL"?l=console.error:l=console.log;const a=Ye[e],u=s.split(`
`);for(let h=0;h<u.length;h++)l(a(`${M.bold(e.toLowerCase())}: [${this.logPrefix}] ${u[h]}`));if(n.length>0&&l(...n),o.data!==void 0&&(o.stringifyData?l(JSON.stringify(o.data,null,4)):l(o.data)),o.throw)throw new Error("see previous message")};logDebug=(e,...t)=>{this.log("DEBUG",e,...t)};logInfo=(e,...t)=>{this.log("INFO",e,...t)};logWarn=(e,...t)=>{this.log("WARN",e,...t)};logError=(e,...t)=>{this.log("ERROR",e,...t)};logFatal=(e,...t)=>{this.log("FATAL",e,...t)}}const qe=new Xe("lib/spritesheets"),{logFatal:Ve}=qe,Je=_e;class ee{constructor(e,t,n){this._relUrlFilepath=e,this._filename=t,this._image=n}get relUrlFilepath(){return this._relUrlFilepath}get filename(){return this._filename}get image(){return this._image}static async loadDefault(){const e=[];for(const t of Je){const n=`${Ae}/${t.relPath}`,i=fetch(n).then(s=>s.blob()).then(createImageBitmap).then(s=>new ee(n,b.parse(t.relPath).base,s)).catch(s=>{throw Ve({msg:"error while loading spritesheets",throw:!0,data:{spritesheet:n,error:s}}),""});e.push(i),await Le(25)}return Promise.all(e)}convertSsIndexToTilePosition(e){return this.assertSsIndexWithinSpritesheet(e),Y(e,O.w)}calculateSpritesheetTileRegion(e){const t=we[e],n=this.convertSsIndexToSsTilePosition(t);return{x:n.x*k,y:n.y*k,w:k,h:k}}convertCardinalNeighborsToTiling(e){let t=c.none;for(const[n,i]of Object.entries(e))i!==void 0&&(t|=c[n]);return t}convertSsIndexToSsTilePosition(e){return Y(e,O.w)}isSsIndexWithinSpritesheet(e){return e<K}assertSsIndexWithinSpritesheet(e){if(!this.isSsIndexWithinSpritesheet(e))throw new Error("failed assert assertSsIndexWithinSpritesheet: "+e)}}function Qe(r,e){return Array.isArray(r)?(e=r[1],r=r[0]):e===void 0&&(e=r,r=0),r+Math.random()*(e-r)}function Ze(...r){return Math.round(Qe.apply(null,r))}function et(r){return r.length>0?Ze(r.length-1):-1}function tt(r){return r[et(r)]}const rt="https://murolem.github.io/ostranauts_funsies/sprite-test/app/assets/trash-bin-black-Bnsn3vaF.png",nt="https://murolem.github.io/ostranauts_funsies/sprite-test/app/assets/paint-brush-black-DGHBLeNn.png",it="https://murolem.github.io/ostranauts_funsies/sprite-test/app/assets/eraser-black-DRmb9ui2.png",st={Tab:9,Clear:12,Shift:16,Control:17,AltGraph:18,Alt:18,CapsLock:20,Escape:27,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Insert:45,Delete:46,0:48,"=":48,1:49,"!":49,2:50,'"':50,3:51,"§":51,4:52,$:52,5:53,"%":53,6:54,"&":54,7:55,"/":55,8:56,"(":56,9:57,")":57,a:65,A:65,b:66,B:66,c:67,C:67,d:68,D:68,e:69,E:69,f:70,F:70,g:71,G:71,h:72,H:72,i:73,I:73,j:74,J:74,k:75,K:75,l:76,L:76,m:77,M:77,n:78,N:78,o:79,O:79,p:80,P:80,Q:81,r:82,R:82,s:83,S:83,t:84,T:84,u:85,U:85,v:86,V:86,w:87,W:87,x:88,X:88,y:89,Y:89,z:90,Z:90,Meta:92,F1:112,F2:113,Ü:186,"+":187,"*":187,",":188,";":188,"-":189,_:189,".":190,":":190,"#":191,"'":191,Ö:192,"?":219,"°":220,Ä:222},ve=[],G=[];function ot(r){return st[r]}window.addEventListener("keyup",r=>{const e=G.findIndex(t=>t.keyCode===r.keyCode);e!==-1&&G.splice(e,1)});window.addEventListener("keydown",r=>{G.findIndex(n=>n.keyCode===r.keyCode)===-1&&G.push({key:r.key,keyCode:r.keyCode});const t=ve.find(n=>n.keyCodes.includes(r.keyCode));t&&t.action([r.key],[r.keyCode])});function lt(r,e){ve.push({keys:[r],keyCodes:[r].map(ot),action:e})}const me="active",B="toggled",ye=125,at=document.querySelector(":root");at.style.setProperty("--btn-press-anim-duration",ye+"ms");function w(r){var e=document.createElement("div");return e.innerHTML=r.trim(),e.firstChild}function ct(){return w('<button class="simple-button"></button>')}function pe(){const r=w('<button class="toggle-button"></button>');return r.addEventListener("click",()=>r.classList.toggle(B)),r}function dt(){return w('<button class="tile-button"></button>')}function ut(r,e,t){const n=w('<label class="button-label-wrapping"></label>'),i=w(`<span class="button-label-text">${e}</span>`);return n.append(r),n.append(i),n}function N(r,{invert:e=!1}={}){return w(`<img src="${r}" class="icon${e?" invert":""}">`)}function ht(){return w("<div></div>")}function j(r,e){const t=ht();return t.classList.add("button-section",`name-${r}`),t.append(...e),t}function U(r,e,{setActiveForClickDuration:t=!1}={}){return lt(e,()=>{r.click(),t&&(r.classList.add(me),setTimeout(()=>r.classList.remove(me),ye))}),ut(r,e)}function ft(r,e){const t=w('<div class="gui-container dock-top"></div>'),n=ct();n.appendChild(N(rt,{invert:!0})),n.addEventListener("click",g=>e.reload?.(g.target));const i=U(n,"A",{setActiveForClickDuration:!0}),s=(g,x)=>{g.classList.contains(B)&&x(g)};let o=null;const l=g=>{if(o&&o===g){g.classList.add(B);return}o&&o.classList.contains(B)&&o.classList.remove(B),o=g},a=pe();a.appendChild(N(nt,{invert:!0})),a.addEventListener("click",g=>{const x=g.target;l(x),s(x,z=>e.selectTool?.(z,"brush"))});const u=U(a,"B"),h=pe();h.appendChild(N(it,{invert:!0})),h.addEventListener("click",g=>{const x=g.target;l(x),s(x,z=>e.selectTool?.(z,"eraser"))});const m=U(h,"E"),T=dt(),f=j("reload",[i]),L=j("tools",[u,m]);j("tile-select",[T]).classList.add("align-right"),t.append(f,L),r.parentElement.append(t),a.click()}if(Object.keys($).length!==K)throw new Error(`mismatch between configuring spritesheet size and tiles and defined mappings: ss size set to ${K} tiles, while index mappings configured for ${Object.keys($).length} tiles`);const S=Se(document.getElementById("canvas"),"canvas element not found");if(S.tagName!=="CANVAS")throw new Error("canvas element is not a canvas element, found: "+S.tagName);const P=S.getContext("2d");if(!P)throw new Error("2d rendering context unsupported");const gt=await ee.loadDefault(),A=new Me(S,P),Q=new Be(A,tt(gt));let te=!1,re=!1,Z={x:0,y:0};window.addEventListener("mousedown",()=>te=!0);window.addEventListener("mouseup",()=>te=!1);S.addEventListener("mousedown",()=>re=!0);S.addEventListener("mouseup",()=>re=!1);S.addEventListener("mousemove",r=>{Z.x=r.offsetX-I,Z.y=r.offsetY-I});ft(S,{reload:r=>{A.clear()},selectTool:(r,e)=>{Q.setMode(e)},selectTileset:(r,e)=>{}});function Te(){if(P.save(),P.translate(I,I),P.imageSmoothingEnabled=!1,P.fillStyle="hsl(0, 0%, 15%)",P.fillRect(0,0,A.sizePixelsPadded.w,A.sizePixelsPadded.h),te&&re){const r=A.convertPxPositionToTilePos(Z);Q.tryApplyAt(r)}A.draw(Q),P.restore(),requestAnimationFrame(Te)}Te();
